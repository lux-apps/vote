{"version":3,"file":"1-Dme9Z57O.js","sources":["../../src/hooks/utils/cache/migrations/1.ts"],"sourcesContent":["import { addNetworkPrefix } from '../../../../utils/url';\n// This should be a temporary hook to migrate the old local storage to the new one\n// and should be removed after a few months\n\nimport { CacheExpiry, CacheKeys } from '../cacheDefaults';\nimport { setValue } from '../useLocalStorage';\n\nconst deleteAllV0FractData = (fractKeys: string[]) => {\n  // delete old cache\n  fractKeys.forEach(key => {\n    localStorage.removeItem(key);\n  });\n};\n\nconst createV1FavoratesData = (v0FavoritesData: string[]) => {\n  if (v0FavoritesData.length === 0) {\n    return;\n  }\n\n  const newFavorites: string[] = [];\n\n  // loop through all favorites\n  for (const v0Favorite of v0FavoritesData) {\n    // Get ChainId from favorite key\n    const [, chainId] = v0Favorite.split('_');\n    if (Number.isNaN(Number(chainId))) {\n      continue;\n    }\n    const v0FavoriteValue = localStorage.getItem(v0Favorite);\n    if (v0FavoriteValue) {\n      // Parse favorites value and add network prefix\n      const v0ParsedValue: { v: string[] } = JSON.parse(v0FavoriteValue);\n      v0ParsedValue.v.forEach((value: string) => {\n        newFavorites.push(addNetworkPrefix(value, Number(chainId)));\n      });\n    }\n  }\n\n  // Set new Favorites cache\n  setValue({ cacheName: CacheKeys.FAVORITES }, newFavorites, CacheExpiry.NEVER);\n};\n\n//@dev for testing seperated the function from the hook and export\nexport default function migration1() {\n  const allV0FractKeys = Object.keys(localStorage).filter(key => key.startsWith('fract_'));\n  const v0FavoritesData = allV0FractKeys.filter(key => key.endsWith('favorites'));\n\n  createV1FavoratesData(v0FavoritesData);\n  deleteAllV0FractData(allV0FractKeys);\n}\n"],"names":["deleteAllV0FractData","fractKeys","key","createV1FavoratesData","v0FavoritesData","newFavorites","v0Favorite","chainId","v0FavoriteValue","value","addNetworkPrefix","setValue","CacheKeys","CacheExpiry","migration1","allV0FractKeys"],"mappings":"6DAOA,MAAMA,EAAwBC,GAAwB,CAEpDA,EAAU,QAAeC,GAAA,CACvB,aAAa,WAAWA,CAAG,CAAA,CAC5B,CACH,EAEMC,EAAyBC,GAA8B,CACvD,GAAAA,EAAgB,SAAW,EAC7B,OAGF,MAAMC,EAAyB,CAAA,EAG/B,UAAWC,KAAcF,EAAiB,CAExC,KAAM,CAAG,CAAAG,CAAO,EAAID,EAAW,MAAM,GAAG,EACxC,GAAI,OAAO,MAAM,OAAOC,CAAO,CAAC,EAC9B,SAEI,MAAAC,EAAkB,aAAa,QAAQF,CAAU,EACnDE,GAEqC,KAAK,MAAMA,CAAe,EACnD,EAAE,QAASC,GAAkB,CACzCJ,EAAa,KAAKK,EAAiBD,EAAO,OAAOF,CAAO,CAAC,CAAC,CAAA,CAC3D,CAEL,CAGAI,EAAS,CAAE,UAAWC,EAAU,SAAa,EAAAP,EAAcQ,EAAY,KAAK,CAC9E,EAGA,SAAwBC,GAAa,CAC7B,MAAAC,EAAiB,OAAO,KAAK,YAAY,EAAE,OAAcb,GAAAA,EAAI,WAAW,QAAQ,CAAC,EACjFE,EAAkBW,EAAe,UAAcb,EAAI,SAAS,WAAW,CAAC,EAE9EC,EAAsBC,CAAe,EACrCJ,EAAqBe,CAAc,CACrC"}